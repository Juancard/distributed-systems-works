
DROP TABLE IF EXISTS USER;
DROP TABLE IF EXISTS PERMISSION;
DROP TABLE IF EXISTS ACCESS_PERMISSION;
DROP TABLE IF EXISTS RESOURCE_PERMISSION;

CREATE TABLE USER (
  user_id INTEGER PRIMARY KEY,
  username VARCHAR(20) UNIQUE,
  pass VARCHAR(20)
);
CREATE TABLE PERMISSION (
  permission_id INTEGER PRIMARY KEY,
  permission_name VARCHAR(20) unique
);
CREATE TABLE ACCESS_PERMISSION (
  ap_id INTEGER PRIMARY KEY,
  user_id references USER,
  permission_id references PERMISSION,
  unique(user_id, permission_id)
);
CREATE TABLE RESOURCE_PERMISSION (
  rp_id INTEGER PRIMARY KEY,
  user_id references USER,
  permission_id references PERMISSION,
  filename VARCHAR(40),
  unique(user_id, permission_id, filename)
);
--permissions are:
INSERT INTO PERMISSION VALUES (1, "dir");
INSERT INTO PERMISSION VALUES (2, "get");
INSERT INTO PERMISSION VALUES (3, "post");
INSERT INTO PERMISSION VALUES (4, "del");

-- user admin is:
INSERT INTO USER VALUES (1, "admin", "admin");

-- user admin has this permissions:
INSERT INTO ACCESS_PERMISSION VALUES (1, 1, 1);
INSERT INTO ACCESS_PERMISSION VALUES (2, 1, 2);
INSERT INTO ACCESS_PERMISSION VALUES (3, 1, 3);
INSERT INTO ACCESS_PERMISSION VALUES (4, 1, 4);

-- other users:
INSERT INTO USER VALUES (2, "juan", "juan");
INSERT INTO ACCESS_PERMISSION VALUES (5, 2, 1);
INSERT INTO ACCESS_PERMISSION VALUES (6, 2, 2);
INSERT INTO ACCESS_PERMISSION VALUES (7, 2, 3);
INSERT INTO ACCESS_PERMISSION VALUES (8, 2, 4);
INSERT INTO RESOURCE_PERMISSION VALUES (1, 2, 1, 'example1.txt');
INSERT INTO RESOURCE_PERMISSION VALUES (2, 2, 2, 'example1.txt');
INSERT INTO RESOURCE_PERMISSION VALUES (3, 2, 3, 'example1.txt');
INSERT INTO RESOURCE_PERMISSION VALUES (4, 2, 4, 'example1.txt');

INSERT INTO USER VALUES (3, "a", "a");
INSERT INTO ACCESS_PERMISSION VALUES (9, 3, 1);
INSERT INTO ACCESS_PERMISSION VALUES (10, 3, 2);